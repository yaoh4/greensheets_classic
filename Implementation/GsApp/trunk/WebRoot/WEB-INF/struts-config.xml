<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
"http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">
<struts-config>

	<!-- ========== Form Beans ========== -->
	<form-beans>

		<!--  Typed Forms -->
		<form-bean name="programPreferencesForm" 
		type="gov.nih.nci.iscs.numsix.greensheets.application.ProgramPreferencesForm" />

		<form-bean name="attachmentsForm" type="org.apache.struts.action.DynaActionForm">
			<form-property name="fileAttachment" type="org.apache.struts.upload.FormFile" />
			<form-property name="fileMemoryId" type="java.lang.String" />
			<form-property name="respDefId" type="java.lang.String" />
			<form-property name="allValidFileNames" type="java.lang.String" />
			<form-property name="formUid" type="java.lang.String" />
			<form-property name="method" type="java.lang.String" />
		</form-bean>

		<form-bean name="savePreferencesForm" type="org.apache.struts.action.DynaActionForm">
			<form-property name="method" type="java.lang.String" />
		</form-bean>

		<form-bean name="changeLockForm" type="org.apache.struts.action.DynaActionForm">
			<form-property name="grantId" type="java.lang.String" />
			<form-property name="applId" type="java.lang.String" />
			<form-property name="groupType" type="java.lang.String" />
		</form-bean>

		<form-bean name="pdfOptionsForm" type="org.apache.struts.action.DynaActionForm">
			<form-property name="formUid" type="java.lang.String" />
			<form-property name="commentsDisplayOption" type="java.lang.String" />
			<form-property name="generateAllQuestions" type="java.lang.String" />
		</form-bean>

		<form-bean name="searchOptionsForm" type="org.apache.struts.action.DynaActionForm">
			<form-property name="searchType" type="java.lang.String" />
			<form-property name="searchText" type="java.lang.String" />
		</form-bean>

	</form-beans>

	<!-- ========== Global Exceptions ========== -->
	<global-exceptions>
		<exception key="error.exception" type="java.lang.Exception" 
		handler="gov.nih.nci.iscs.numsix.greensheets.fwrk.GreensheetsExceptionHandler" />
	</global-exceptions>

	<!-- ========== Global Forwards ========== -->
	<global-forwards>
		<forward name="welcome" path="/testForm.do" redirect="true" />

		<forward name="retrievegrants" path="/retrievegrants.do" />
		<forward name="guestUserView" path="/jsp/GuestUserView.jsp" />
		<forward name="guestUserGrantsList" path="/jsp/GuestUserGrantsList.jsp" />
		<forward name="specialistGrantsList" path="/jsp/SpecialistUserGrantsList.jsp" />
		<forward name="programGrantsList" path="/searchprogramgrants.do?method=search" />

		<forward name="vmid" path="/velocityViewId" />
		<forward name="closeDialog" path="/jsp/CloseDialog.jsp" />
		<forward name="error" path="/jsp/error.jsp" />
		<forward name="attachments" path="/jsp/QuestionAttachments.jsp" />
		<forward name="actionConfirm" path="/jsp/ActionConfirm.jsp" />
		<forward name="templatenotfound" path="/jsp/TemplateNotFound.jsp" />
		<forward name="retrievegreensheet" path="/retrievegreensheet.do" />
		<forward name="templateloadstatus" path="/jsp/TemplateLoadStatus.jsp" />
		<forward name="sessionTimeOut" path="/jsp/SessionTimeOut.jsp" />
		<forward name="viewCurrentPreferences" path="/jsp/ViewCurrentPreferences.jsp" />
	</global-forwards>
  
	<!-- ========== Action Mapping Definitions ========== -->
	<action-mappings>

		<!--  Main entry point to the appl. Uses user role to select appropriate forward,  
			retrieve grants data and present the appropriate page for Guest and Specialist Roles.
			Forwards to guestUserView, guestUserGrantsList, specialistGrantsList and 
			with special handling for programGrantsList (see forward)-->
		<action path="/retrievegrants" type="gov.nih.nci.iscs.numsix.greensheets.application.RetrieveUsersGrantsAction" 
		scope="request" />

		<!--  Program Grants Actions -->
		<action path="/searchprogramgrants" parameter="method" name="programPreferencesForm" 
		type="gov.nih.nci.iscs.numsix.greensheets.application.SearchProgramGrantsAction" 
		input="/jsp/ProgramUserGrantsList.jsp" scope="request">
			<forward name="success" path="/jsp/ProgramUserGrantsList.jsp" />
		</action>
		<action path="/searchprogramgrantsdispatch"
		name="programPreferencesForm"
		type="org.apache.struts.scaffold.FindForwardAction"
		input="/jsp/ProgramUserGrantsList.jsp"
		parameter="method"
		scope="request">	
    		<forward name="image_search.x" path="/searchprogramgrants.do?method=search" />
    		<forward name="image_cancel.x" path="/searchprogramgrants.do?method=cancel" />
            <forward name="image_restorePreferences.x" path="/searchprogramgrants.do?method=restorePreferences" />    		
		</action>
		
		<action path="/editprogrampreferences" parameter="method" name="programPreferencesForm"
		type="gov.nih.nci.iscs.numsix.greensheets.application.EditProgramPreferencesAction"
		input="/jsp/EditProgramPreferences.jsp" scope="request">
			<forward name="success" path="/jsp/EditProgramPreferences.jsp" />
		</action>
		<action path="/editprogrampreferencesdispatch"
		name="programPreferencesForm"
		type="org.apache.struts.scaffold.FindForwardAction"
		input="/jsp/EditProgramPreferences.jsp"
		scope="request">	
    		<forward name="image_savePreferences.x" path="/saveprogrampreferences.do" />
    		<forward name="image_cancel.x" path="/searchprogramgrants.do?method=cancel" />
		</action>		

		<action path="/saveprogrampreferences" name="programPreferencesForm" 
		type="gov.nih.nci.iscs.numsix.greensheets.application.SaveProgramPreferencesAction" scope="request">
			<forward name="success" path="/jsp/ViewProgramPreferences.jsp" />
		</action>		

		<!--  Guest & Specialist Search Action -->
		<action path="/searchforgrant" type="gov.nih.nci.iscs.numsix.greensheets.application.SearchForGrantAction" name="searchOptionsForm" scope="request" />

		<action path="/no_op" type="gov.nih.nci.iscs.numsix.greensheets.application.NoOpAction" scope="request" />

		<action path="/retrievegreensheet" type="gov.nih.nci.iscs.numsix.greensheets.application.RetrieveGreensheetAction" scope="request" />

		<action path="/savesubmit" type="gov.nih.nci.iscs.numsix.greensheets.application.SaveSubmitCloseAction" parameter="method" scope="request" />

		<action path="/questionattachments" name="attachmentsForm" type="gov.nih.nci.iscs.numsix.greensheets.application.QuestionAttachmentsAction" parameter="method" scope="request" />

		<action path="/changelock" name="changeLockForm" type="gov.nih.nci.iscs.numsix.greensheets.application.ChangeGreensheetLockAction" scope="request" />

		<action path="/getgreensheetpdf" type="gov.nih.nci.iscs.numsix.greensheets.application.RetreiveGreensheetAsPdfAction" name="pdfOptionsForm" scope="request" />

		<action path="/status" type="gov.nih.nci.iscs.numsix.greensheets.application.ErrorTestAction" scope="request" />

		<action path="/linkTest" forward="/jsp/LinkTest.jsp" />

		<action path="/reloadXmlSrc" forward="/jsp/ReloadXmlSrc.jsp" />

		<action path="/specialistSubmittedStatus" forward="/jsp/SpecialistSubmitStatus.jsp" />

		<action path="/closeDialog" forward="/jsp/CloseDialog.jsp" />

		<action path="/pdfgeneration" forward="/jsp/PdfGenerationOptions.jsp" />

	</action-mappings>

	<controller processorClass="gov.nih.nci.iscs.numsix.greensheets.fwrk.GreensheetsRequestProcessor" />

	<!-- ========== Message Resources ========== -->
	<message-resources parameter="ApplicationResources" />

	<!-- ========== Plug-In Defintions ========== -->
	<plug-in className="gov.nih.nci.iscs.numsix.greensheets.fwrk.GreensheetsInitPlugIn" />

</struts-config>
